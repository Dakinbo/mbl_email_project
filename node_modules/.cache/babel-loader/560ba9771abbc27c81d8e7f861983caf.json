{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Pictures\\\\mbl\\\\project\\\\src\\\\MessageList.js\";\nimport React, { Component } from 'react';\nimport Toolbar from './Toolbar';\nimport Message from './Message';\nimport Compose from './Compose';\nimport axios from 'axios';\nvar url = process.env.REACT_APP_BASE_URL;\n\nvar MessageList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MessageList, _Component);\n\n  function MessageList(props) {\n    var _this;\n\n    _classCallCheck(this, MessageList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MessageList).call(this, props));\n\n    _this.findUnread = function () {\n      return _this.state.messages.reduce(function (i, message) {\n        return message.read === false ? i + 1 : i;\n      }, 0);\n    };\n\n    _this.messageLength = function () {\n      var i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      return _this.state.messages.length + i;\n    };\n\n    _this.selectedMessage = function () {\n      return Object.keys(_this.state.selected).filter(function (id) {\n        return _this.state.selected[id] === true;\n      });\n    };\n\n    _this.selectedLength = function () {\n      return _this.selectedMessage().length;\n    };\n\n    _this.selectedId = function () {\n      return Object.keys(_this.state.selected).filter(function (id) {\n        return _this.state.selected[id] === true && id;\n      });\n    };\n\n    _this.isSelected = function (id) {\n      return _this.state.selected[id] || false;\n    };\n\n    _this.getMessages =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get(url);\n\n            case 3:\n              response = _context.sent;\n\n              _this.setState({\n                messages: response.data\n              });\n\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 7]]);\n    }));\n\n    _this.request =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(command) {\n        var key,\n            value,\n            id,\n            _args2 = arguments;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                key = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : null;\n                value = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : null;\n                id = _this.selectedId();\n                _context2.prev = 3;\n                _context2.next = 6;\n                return axios.patch(url, _defineProperty({\n                  command: command,\n                  messageIds: id\n                }, key, value));\n\n              case 6:\n                _this.getMessages();\n\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](3);\n                console.log(_context2.t0);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[3, 9]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.handleDelete = function () {\n      return _this.request('delete');\n    };\n\n    _this.handleRead = function (value) {\n      return _this.request('read', 'read', value);\n    };\n\n    _this.handleLabels = function (label, type) {\n      return _this.request(type, 'label', label);\n    };\n\n    _this.clickToggleRead =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(id) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return axios.patch(url, {\n                  command: 'read',\n                  messageIds: [id],\n                  read: true\n                });\n\n              case 3:\n                _this.setState({\n                  messages: _this.state.messages.map(function (message) {\n                    return message.id === id ? _objectSpread({}, message, {\n                      viewing: !message.viewing,\n                      read: true\n                    }) : _objectSpread({}, message);\n                  })\n                });\n\n                _context3.next = 9;\n                break;\n\n              case 6:\n                _context3.prev = 6;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.log(_context3.t0);\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 6]]);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.handleStar =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(id) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return axios.patch(url, {\n                  command: 'star',\n                  messageIds: [id]\n                });\n\n              case 3:\n                _this.setState({\n                  messages: _this.state.messages.map(function (message) {\n                    return message.id === id ? _objectSpread({}, message, {\n                      viewing: !!message.viewing,\n                      starred: !message.starred\n                    }) : _objectSpread({}, message);\n                  })\n                });\n\n                _context4.next = 9;\n                break;\n\n              case 6:\n                _context4.prev = 6;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 9:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 6]]);\n      }));\n\n      return function (_x3) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.handleChecked = function (id) {\n      if (_this.state.selected.hasOwnProperty.id) {\n        var selected = Object.keys(_this.state.selected).reduce(function (acc, val) {\n          return val === id ? _objectSpread({}, acc, _defineProperty({}, id, !_this.state.selected[id])) : _objectSpread({}, acc, _defineProperty({}, id, true));\n        }, {});\n\n        _this.setState({\n          selected: selected\n        });\n      } else {\n        var _selected = _objectSpread({}, _this.state.selected, _defineProperty({}, id, !_this.state.selected[id]));\n\n        _this.setState({\n          selected: _selected\n        });\n      }\n    };\n\n    _this.selectIcons = function () {\n      var state = _this.messageLength();\n\n      var selected = _this.selectedLength();\n\n      return selected === state ? \"fa-check-square-o\" : selected < state && selected > 0 ? \"fa-minus-square-o\" : selected === 0 && \"fa-square-o\";\n    };\n\n    _this.selectAll = function () {\n      var ids = _this.state.messages.map(function (_ref5) {\n        var id = _ref5.id;\n        return id;\n      });\n\n      var selected = ids.reduce(function (acc, id) {\n        return _objectSpread({}, acc, _defineProperty({}, id, true));\n      }, {});\n\n      _this.setState({\n        selected: _this.selectedLength() === _this.messageLength() ? {} : selected\n      });\n    };\n\n    _this.showForm = function () {\n      _this.setState({\n        composing: !_this.state.composing\n      });\n    };\n\n    _this.compose =\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(message) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return axios.post(url, message);\n\n              case 3:\n                _this.getMessages();\n\n                _context5.next = 9;\n                break;\n\n              case 6:\n                _context5.prev = 6;\n                _context5.t0 = _context5[\"catch\"](0);\n                console.log(_context5.t0);\n\n              case 9:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 6]]);\n      }));\n\n      return function (_x4) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      messages: [],\n      selected: {},\n      composing: false\n    };\n    return _this;\n  }\n\n  _createClass(MessageList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getMessages();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        composing: this.state.composing,\n        messageLength: this.messageLength,\n        selectedMessage: this.selectedMessage,\n        selectedLength: this.selectedLength,\n        findUnread: this.findUnread,\n        handleDelete: this.handleDelete,\n        handleLabels: this.handleLabels,\n        handleRead: this.handleRead,\n        selectIcons: this.selectIcons,\n        selectAll: this.selectAll,\n        showForm: this.showForm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), this.state.composing && React.createElement(Compose, {\n        messageLength: this.messageLength,\n        compose: this.compose,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }), this.state.messages.map(function (message) {\n        return React.createElement(Message, Object.assign({\n          key: message.id\n        }, message, {\n          selected: _this2.isSelected(message.id),\n          clickToggleRead: _this2.clickToggleRead,\n          handleStar: _this2.handleStar,\n          handleChecked: _this2.handleChecked,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }));\n      }));\n    }\n  }]);\n\n  return MessageList;\n}(Component);\n\nexport { MessageList as default };","map":{"version":3,"sources":["C:\\Users\\Admin\\Pictures\\mbl\\project\\src\\MessageList.js"],"names":["React","Component","Toolbar","Message","Compose","axios","url","process","env","REACT_APP_BASE_URL","MessageList","props","findUnread","state","messages","reduce","i","message","read","messageLength","length","selectedMessage","Object","keys","selected","filter","id","selectedLength","selectedId","isSelected","getMessages","get","response","setState","data","console","log","request","command","key","value","patch","messageIds","handleDelete","handleRead","handleLabels","label","type","clickToggleRead","map","viewing","handleStar","starred","handleChecked","hasOwnProperty","acc","val","selectIcons","selectAll","ids","showForm","composing","compose","post"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport Toolbar from './Toolbar'\nimport Message from './Message'\nimport Compose from './Compose'\nimport axios from 'axios'\nconst url = process.env.REACT_APP_BASE_URL\n\nexport default class MessageList extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      messages: [],\n      selected: {},\n      composing: false\n    }\n  }\n\n  componentDidMount() { this.getMessages() }\n\n  findUnread = () => this.state.messages.reduce((i, message) => message.read === false ? i + 1 : i, 0)\n  messageLength = (i = 0) => this.state.messages.length + i\n  selectedMessage = () => Object.keys(this.state.selected).filter(id => this.state.selected[id] === true)\n  selectedLength = () => this.selectedMessage().length\n  selectedId = () => Object.keys(this.state.selected).filter(id => this.state.selected[id] === true && id )\n  isSelected = (id) => this.state.selected[id] || false\n\n  getMessages = async () => {\n    try {\n      const response = await axios.get(url)\n      this.setState({\n        messages: response.data\n      })\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  request = async (command, key = null, value = null) => {\n    const id = this.selectedId()\n    try {\n      await axios.patch(url, { command: command, messageIds: id, [key] : value })\n      this.getMessages()\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  handleDelete = () => this.request('delete')\n  handleRead = (value) => this.request('read', 'read', value)\n  handleLabels = (label, type) => this.request(type, 'label', label)\n\n  clickToggleRead = async (id) => {\n    try {\n      await axios.patch(url, { command: 'read', messageIds: [id], read: true })\n      this.setState({\n        messages: this.state.messages.map(message => {\n          return message.id === id ? { ...message, viewing: !message.viewing, read: true } : { ...message }\n        })\n      })\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  handleStar = async (id) => {\n    try {\n      await axios.patch(url, { command: 'star', messageIds: [id] })\n      this.setState({\n        messages: this.state.messages.map(message => {\n          return message.id === id ? { ...message, viewing: !!message.viewing, starred: !message.starred } : { ...message }\n        })\n      })\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  handleChecked = (id) => {\n    if (this.state.selected.hasOwnProperty.id) {\n      const selected = Object.keys(this.state.selected).reduce((acc, val) => {\n        return val === id ? { ...acc, [id]: !this.state.selected[id] } : { ...acc, [id]: true }\n      }, {})\n      this.setState({ selected })\n    }\n    else {\n      const selected = { ...this.state.selected, [id]: !this.state.selected[id] }\n      this.setState({ selected })\n    }\n  }\n\n  selectIcons = () => {\n    let state = this.messageLength()\n    let selected = this.selectedLength()\n\n    return selected === state ? \"fa-check-square-o\"\n      : selected < state && selected > 0 ? \"fa-minus-square-o\"\n        : selected === 0 && \"fa-square-o\"\n  }\n\n  selectAll = () => {\n    const ids = this.state.messages.map(({ id }) => id)\n    const selected = ids.reduce((acc, id) => ({ ...acc, [id]: true }), {})\n\n    this.setState({\n      selected: this.selectedLength() === this.messageLength() ? {} : selected\n    })\n  }\n\n  showForm = () => {\n    this.setState({\n      composing: !this.state.composing\n    })\n  }\n\n  compose = async (message) => {\n    try {\n      await axios.post(url, message)\n      this.getMessages()\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Toolbar\n          composing={this.state.composing}\n          messageLength={this.messageLength}\n          selectedMessage={this.selectedMessage}\n          selectedLength={this.selectedLength}\n          findUnread={this.findUnread}\n          handleDelete={this.handleDelete}\n          handleLabels={this.handleLabels}\n          handleRead={this.handleRead}\n          selectIcons={this.selectIcons}\n          selectAll={this.selectAll}\n          showForm={this.showForm}\n        />\n        {\n          this.state.composing &&\n          <Compose\n            messageLength={this.messageLength}\n            compose={this.compose}\n          />\n        }\n        {\n          this.state.messages.map(message =>\n            <Message\n              key={message.id}\n              {...message}\n              selected={this.isSelected(message.id)}\n              clickToggleRead={this.clickToggleRead}\n              handleStar={this.handleStar}\n              handleChecked={this.handleChecked}\n            />\n          )\n        }\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}